<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Introduction of MACI - FoodChain</title><meta content="在區塊鏈投票時，常會發生「共謀」的現象 (最常見的就是賄賂 )，而為了遏止此現象的發生，Barry White Hat 與 Ethereum 中其他成員建構了 MACI 這個 protocol..." name="description"/><meta property="og:url" content="https://foodchain.eth.xyz/posts/MACI"/><link rel="canonical" href="https://foodchain.eth.xyz/posts/MACI"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Hunter Chang - Website"/><meta property="og:description" content="在區塊鏈投票時，常會發生「共謀」的現象 (最常見的就是賄賂 )，而為了遏止此現象的發生，Barry White Hat 與 Ethereum 中其他成員建構了 MACI 這個 protocol..."/><meta property="og:title" content="Introduction of MACI - FoodChain"/><meta property="og:image" content="https:foochain1028.eth.xyzundefined"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@huntarosan"/><meta name="twitter:title" content="Introduction of MACI - FoodChain"/><meta name="twitter:description" content="在區塊鏈投票時，常會發生「共謀」的現象 (最常見的就是賄賂 )，而為了遏止此現象的發生，Barry White Hat 與 Ethereum 中其他成員建構了 MACI 這個 protocol..."/><meta name="twitter:image" content="https:foochain1028.eth.xyzundefined"/><meta property="article:published_time" content="2023-02-04"/><meta name="next-head-count" content="17"/><link rel="preload" href="/_next/static/css/09d135de262dea08.css" as="style"/><link rel="stylesheet" href="/_next/static/css/09d135de262dea08.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-153ca532c98eee0d.js" defer=""></script><script src="/_next/static/chunks/pages/_app-8c286cbce58fc284.js" defer=""></script><script src="/_next/static/chunks/306-faf99b336d274355.js" defer=""></script><script src="/_next/static/chunks/358-59e534127f537b93.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-438ed546bdadfc5d.js" defer=""></script><script src="/_next/static/Gy7Rb-D_XwjaylTu5JJGQ/_buildManifest.js" defer=""></script><script src="/_next/static/Gy7Rb-D_XwjaylTu5JJGQ/_ssgManifest.js" defer=""></script></head><body class="bg-white dark:bg-black text-gray-900 dark:text-white"><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if(e){c.add(e|| '')}else{c.add('dark');}if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'dark'}catch(t){}}();</script><header><div class="max-w-5xl px-8 mx-auto"><div class="flex items-center justify-between py-6"><nav><a class="text-gray-900 dark:text-yellow-200 pr-6 py-4" href="/">Home</a><a class="text-gray-900 dark:text-yellow-200 px-6 py-4" href="/projects">Projects</a><a class="text-gray-900 dark:text-yellow-200 px-6 py-4" href="/posts">Posts</a></nav></div></div></header><main><div class="max-w-5xl px-8 py-4 mx-auto"><article><h1 class="mb-3 text-gray-900 dark:text-white">Introduction of MACI</h1><p class="mb-10 text-sm text-gray-500 dark:text-gray-400">February 04, 2023</p><div class="prose dark:prose-dark"><h2 id="minimum-anti-collusion-infrastructure-maci"><a class="anchor" href="#minimum-anti-collusion-infrastructure-maci"><span class="icon icon-link"></span></a>Minimum Anti-Collusion Infrastructure (MACI)</h2>
<h2 id="author--acknowledgement"><a class="anchor" href="#author--acknowledgement"><span class="icon icon-link"></span></a>Author &amp; acknowledgement</h2>
<p>Author: Fu-Chuan Chung @swfLAB</p>
<p>Special thanks to @ for reviewing this article</p>
<h2 id="建議具備知識"><a class="anchor" href="#建議具備知識"><span class="icon icon-link"></span></a>建議具備知識</h2>
<ul>
<li>hash function</li>
<li>merkle tree</li>
<li>ECDSA、EDDSA</li>
<li>ethereum transaction</li>
<li>smart contract written by solidity</li>
</ul>
<h2 id="目錄"><a class="anchor" href="#目錄"><span class="icon icon-link"></span></a>目錄</h2>
<ul>
<li>簡介</li>
<li>共謀</li>
<li>MACI higher-level  (基礎 )</li>
<li>MACI technical-level (深入 )</li>
<li>結論</li>
</ul>
<h2 id="簡介"><a class="anchor" href="#簡介"><span class="icon icon-link"></span></a>簡介</h2>
<p>MACI 的全名為 Minimum Anti-collusion Infrastructure，最初由 <em>Vitalik</em> 在<a href="https://ethresear.ch/t/minimal-anti-collusion-infrastructure/5413">這篇貼文</a>提出，想法源自解決在區塊鏈上<a href="https://vitalik.ca/general/2019/04/03/collusion.html">共謀</a> (中文版詳見<a href="https://cla2srbchi.medium.com/%E7%BF%BB%E8%AD%AF-vitalik-on-collusion-%E8%AB%96%E5%85%B1%E8%AC%80-8ecd4e012266">此</a> )的問題，後續主要由 <em>BarryWhiteHat</em> 與 <em>Kendrick Tan, Kobi Gurkan</em> 和 <em>Koh Wei Jie</em> 等人共同開發。</p>
<h2 id="共謀"><a class="anchor" href="#共謀"><span class="icon icon-link"></span></a>共謀</h2>
<blockquote>
<p>為了避免產生語意上的差異，先說明關於一些名詞的解釋，我也會用圖案來呈現兩者差異</p>
</blockquote>
<ul>
<li>😈  行賄者 = 操縱者 = 意圖改變投票結果的人。</li>
<li>🤑  受賄者 = 投票者 = 可以透過投票獲得來自行賄者利益的人。</li>
</ul>
<p><strong>在深入介紹 MACI 之前，需要先理解何謂共謀 (collusion )？</strong></p>
<p>「有些人會為了自己的利益串通他人，導致多數人的資源掌握在少數人手上」，這類的現象被稱為「共謀」。最常被舉到的例子就是「賄賂 (bribing )」，例如在投票時 😈 行賄者會為了投票結果而不擇手段地去收買、廣告、吸引票源。</p>
<p>觀察現實中的投票情景，政府會透過法律來限制賄賂的發生、投票的隱私、審/計票人員的公正等。但在區塊鏈中，由於任何資訊都是透明公開的，沒有任何有效的制度或法律可以限制共謀的行為。</p>
<p>甚至區塊鏈中的賄賂場景可能會以另一種較隱晦、難以看透的方式存在。例如某些 😈 行賄者會告訴投票者：「這並非賄賂，而是可分享利潤的質押」，使得在區塊鏈中賄賂變得明目張膽，也會因對於 😈 行賄者與 🤑 受賄者無法懲罰而難以遏止。
這邊舉一個在區塊鏈上投票的例子：</p>
<pre class="language-solidity"><code class="language-solidity code-highlight"><span class="code-line"><span class="token comment">// SPDX-License-Identifier: MIT</span>
</span><span class="code-line"><span class="token keyword">pragma</span> <span class="token keyword">solidity</span> <span class="token operator">^</span><span class="token version number">0.8.0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">contract</span> <span class="token class-name">Voting</span> <span class="token punctuation">{</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">mapping</span> <span class="token punctuation">(</span><span class="token builtin">bytes32</span> <span class="token operator">=&gt;</span> <span class="token builtin">uint256</span><span class="token punctuation">)</span> <span class="token keyword">public</span> votesReceived<span class="token punctuation">;</span> <span class="token comment">// 用來記錄候選人獲得的票數</span>
</span><span class="code-line">  <span class="token keyword">mapping</span> <span class="token punctuation">(</span><span class="token builtin">address</span> <span class="token operator">=&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token keyword">public</span> voters<span class="token punctuation">;</span> <span class="token comment">// 投票者名單</span>
</span><span class="code-line">  <span class="token keyword">mapping</span> <span class="token punctuation">(</span><span class="token builtin">bytes32</span> <span class="token operator">=&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token keyword">public</span> candidateList<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">/* constructor input example:
</span></span><span class="code-line"><span class="token comment">    // John, Alice, Bob after keccak256
</span></span><span class="code-line"><span class="token comment">    [
</span></span><span class="code-line"><span class="token comment">			0x0bfa36c40b8771f59912a8b06e3ba9cd68504e69345a0ebcb952c3c6100ec88e,
</span></span><span class="code-line"><span class="token comment">			0x6070f87e7650727769f301b1e264c58d77a49792dc17c13fe3cb44a9bb1f7b44,
</span></span><span class="code-line"><span class="token comment">			0x780641b8ceca510c40f5f0178d126444811cc3e3edf7fa86f3656f77615dcc5c
</span></span><span class="code-line"><span class="token comment">		],
</span></span><span class="code-line"><span class="token comment">    [
</span></span><span class="code-line"><span class="token comment">			0xB5e30182B2EC04A58C8dFaB9f0E42Bbd5a551618,
</span></span><span class="code-line"><span class="token comment">			0x5B38Da6a701c568545dCfcB03FcB875f56beddC4,
</span></span><span class="code-line"><span class="token comment">			0xAb8483F64d9C6d1EcF9b849Ae677dD3315835cb2,
</span></span><span class="code-line"><span class="token comment">			0x4B20993Bc481177ec7E8f571ceCaE8A9e22C02db
</span></span><span class="code-line"><span class="token comment">		]
</span></span><span class="code-line"><span class="token comment">  */</span>
</span><span class="code-line">  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token builtin">bytes32</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">memory</span> _candidateNames<span class="token punctuation">,</span> <span class="token builtin">address</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">memory</span> _voters<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token builtin">uint8</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _candidateNames<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 候選人名單</span>
</span><span class="code-line">      candidateList<span class="token punctuation">[</span>_candidateNames<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token builtin">uint8</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _voters<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 投票的白名單</span>
</span><span class="code-line">      voters<span class="token punctuation">[</span>_voters<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">function</span> <span class="token function">voteForCandidate</span><span class="token punctuation">(</span><span class="token builtin">bytes32</span> candidate<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span> <span class="token comment">// 投票</span>
</span><span class="code-line">    <span class="token keyword">require</span><span class="token punctuation">(</span>candidateList<span class="token punctuation">[</span>candidate<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;input is not a candidate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">require</span><span class="token punctuation">(</span>voters<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;invalid voter&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    votesReceived<span class="token punctuation">[</span>candidate<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<p>這個合約利用 bytes32 來作為候選者的名稱，投票者可以透過 <code>voteForCandidate()</code> ，直接輸入候選人的名稱進行投票。</p>
<p>任何人都可以從 etherscan 上直接看見我在鏈上投票的<a href="https://goerli.etherscan.io/tx/0xb6cd91327376b63b8a2b1227ccc8b6a6b3ccc4141e5c4f303b7b80618dd22b86">結果</a>，就是投給 <em>John</em>。</p>
<pre><code class="code-highlight"><span class="code-line">Function: voteForCandidate(bytes32 candidate) ***
</span><span class="code-line">
</span><span class="code-line">MethodID: 0xcc9ab267
</span><span class="code-line">[0]:  0bfa36c40b8771f59912a8b06e3ba9cd68504e69345a0ebcb952c3c6100ec88e
</span><span class="code-line">(byte32 of keccak256(&quot;John&quot;))
</span></code></pre>
<ul>
<li>😈  行賄者可以透過撰寫 script 抓取鏈上資料，或甚至可以直接透過智能合約來完成賄賂。</li>
<li>🤑  受賄絡者可自行提供在鏈上投票的證明給 😈  行賄者。</li>
</ul>
<p>這樣子使得在區塊鏈上進行投票變得非常困難，</p>
<p>透過 MACI 建構的系統/ App <strong>可以讓共謀者難以進行共謀</strong>，且同時保留了審查的機制與在鏈上進行投票等特性。</p>
<hr/>
<h2 id="maci-流程："><a class="anchor" href="#maci-流程："><span class="icon icon-link"></span></a>MACI 流程：</h2>
<p>以下則會分成兩個流程講述：</p>
<p>第一個是在較高層次 (high-level )觀察投票流程，會利用一個例子來解釋 MACI 投票的流程，另一個流程則會解釋在投票時使用的技術 (technical-level )，本流程參考自此篇文章。</p>
<h3 id="high-level"><a class="anchor" href="#high-level"><span class="icon icon-link"></span></a>High Level</h3>
<p>這邊會講述投票者如何與系統互動進行投票。
<strong>前提</strong>：
⭐️ 整個系統中會有兩個身份：</p>
<ul>
<li>投票者 (Voter )：可以將一組公鑰送入 contract 中，使自己的身份變成投票者。</li>
<li>計票者 (Coordinator )：系統中負責計票的角色，會進行計票的工作，其公鑰會公開讓所有人知道。</li>
</ul>
<p>⭐️ <strong>基本流程</strong>：</p>
<ol>
<li>註冊</li>
<li>投票 (簽章與加密 )</li>
<li>計票</li>
</ol>
<p><strong>投票流程 (實例 )</strong>：</p>
<p>這個例子中有：</p>
<ul>
<li>三個投票者：Alice、Bob、Charlie，其公私鑰分別為 keyPairA: (pubKeyA, privKeyA)、keyPairB、keyPairC。</li>
<li>一個計票者：David，其公私鑰分別為 pubKeyD (公開的資訊 )、privKeyD (只有 David 知道 )。</li>
</ul>
<ol>
<li>在建立合約後會有一個 sign-up 階段 (時間到了便無法再加入 )，投票者只有在這時候可以加入投票。此時 Alice、Bob、Charlie 則需要將他們的公鑰送到 MACI 的合約中以完成註冊。 (這邊的公私鑰並不是進行交易錢包中的那一對公私鑰，而是由鏈下 app 產生的公私鑰對 )</li>
<li>當 Alice 投票時，會將他的票 X (一段 message，像是上面例子中的 bytes32 )透過 privKeyA 簽章，得到 privA(X)</li>
<li>privA(X) 再經過 David 的 pubKeyD 加密，得到 encD(privA(X))，最後透過 MACI 的合約完成投票。</li>
<li>透過 David 的公鑰加密後便只有 David 可以解開，因此只有 David 知道 Alice 到底投了什麼。</li>
<li>此時若 😈 Bob 與 🤑 Alice 為行賄者與受賄者：Bob 便無法從鏈上直接得知 Alice 投給了誰；Alice 也無法透過鏈上的紀錄來向 Bob 證明他的投票結果。</li>
<li>若 Alice 在投票時不幸被 Bob 逼迫，投給了 Alice 不想投的人。MACI 也提供了一個機制，可以讓 Alice 換一組公私鑰對 keyPairA&#x27;: (privKeyA&#x27;, pubKeyA&#x27;)，再經由上述的 2、3 步驟進行投票。 (MACI 在最後計票時，會將原本的票數作廢，只計算其最新產生的票 )</li>
<li>最後，當投票時間結束時，計票人 David 會從合約將每張票 (簽章 &amp; 加密後的資訊 )抓下來，計算結果，並產生一段 zk proof 到合約上以更新票數。</li>
</ol>
<p><img src="https://i.imgur.com/N5ZzWOd.png" alt=""/>
圖一、MACI 投票的簡化流程圖</p>
<p>透過 MACI，除了可以保護 Alice 的隱私 (只有計票者可以解密並紀錄 Alice 的投票結果 )，也可以提高賄賂的難度，使<strong>共謀在 MACI 建立的投票系統下變的窒礙難行</strong>。</p>
<hr/>
<h2 id="technical-level"><a class="anchor" href="#technical-level"><span class="icon icon-link"></span></a>Technical-Level</h2>
<p>此段會是上段流程更深入的探討。</p>
<p><strong>前提：</strong></p>
<p>⭐️ 在 MACI 中投票或更換公鑰等未加密之動作稱為指令 (command )，而加密後的資訊稱為訊息 (message )。</p>
<p>⭐️ 加密流程：</p>
<ol>
<li>將指令 (傳入內容 msg )雜湊後得到 h。</li>
<li>利用系統給予的 EdDSA privKey ，將 h 進行簽章。</li>
<li>利用一個隨機產生的 ephemeral key 與計票者的 pubKey&#x27; 產生出一組 ECDH shared key - Ekey。</li>
<li>最後透過 Ekey 將簽章與指令中的 data 進行加密。 (計票者可以透過他的 privKey&#x27; 解開 )</li>
</ol>
<p><strong>投票流程</strong>：</p>
<ol>
<li>
<p>首先，計票者會將投票的合約部署到鏈上，並開始 sign-up 階段，會將他的 pubKey’ 公開地儲存在合約中。</p>
</li>
<li>
<p>在 sign-up 階段，系統會隨機產生一組 EdDSA 計算出的公私鑰對給予投票者，投票者需要保存自己的私鑰 (privKey )，並將公鑰 (pubKey )傳到合約上進行註冊。<strong>合約中會有一棵 Merkle Tree 紀錄整個投票者的註冊狀態、投票權重等 (詳細可見圖 X )</strong>。
<img src="https://i.imgur.com/LanzW4W.png" alt=""/><br/>
<!-- -->圖 X、Sign-up 流程圖。</p>
</li>
<li>
<p>sign-up 階段結束，無法再加入其他的投票者，並進入投票階段。</p>
</li>
<li>
<p>投票時，投票者可以做兩種行為 (這些行為都可以透過 <code>publishMessage()</code> 更新在合約中 )：</p>
<ol>
<li>
<p>投票：
投票者投的資訊會經由下面的處理上傳至合約中，並將訊息儲存在一棵 Message Tree 中：</p>
<ul>
<li>將指令 (投票內容 )雜湊後得到 hash。</li>
<li>利用系統給予的 EdDSA privKey ，將 hash 進行簽章。</li>
<li>利用一個隨機產生的 ephemeral key 與計票者的 pubKey’ 產生出一組 <a href="https://zh.wikipedia.org/wiki/%E6%A9%A2%E5%9C%93%E6%9B%B2%E7%B7%9A%E8%BF%AA%E8%8F%B2-%E8%B5%AB%E7%88%BE%E6%9B%BC%E9%87%91%E9%91%B0%E4%BA%A4%E6%8F%9B">ECDH</a> shared key Ekey。 (計票者可以透過他的 )</li>
<li>最後透過 Ekey 將<strong>簽章與指令中的 data 進行加密。</strong></li>
</ul>
</li>
<li>
<p>更改公鑰：</p>
<p>若某人被 😈  行賄者逼迫投出非意願的票時，可以透過 publisgMessage 更改其公鑰，而更改的動作其實與投票類似，只是在一開始簽章時將傳入的投票訊息改成新的公鑰 (newPubKey )，更改後便可以用新的公鑰再進行投票了。</p>
</li>
</ol>
<p>關於 message 的敘述可見圖 Y。</p>
<p><img src="https://i.imgur.com/129kbaI.png" alt=""/>
圖 Y、來自 Vitalik 在 <a href="https://ethresear.ch/t/minimal-anti-collusion-infrastructure/5413">ethresear 中提案</a>的內容。</p>
</li>
<li>
<p>投票階段結束，計票者需要<strong>解密與紀錄</strong>所有人的票以統計結果。</p>
</li>
<li>
<p>避免計票者黑箱，在計票時會<strong>使用 zk-snark 的 proof</strong> 讓系統可以不透過公布投票者投出的票卷內容，但可以證實所有計票的公正性 (類似實體投票時的唱票，在旁有投票者監督 )。</p>
</li>
</ol>
<p>在 MACI 中有兩個 zk-SNARK circuit，也代表計票者需要執行的兩個動作 (process &amp; tally )：</p>
<p><strong>Process</strong>：是用來證實在<strong>鏈上 state tree transition 的正確性 (確認所有票都是 valid )</strong>，其中會檢查三件事：</p>
<ul>
<li>使用正確的 key 進行加密。</li>
<li>解密出來的 message 有儲存在 message tree 中。</li>
<li>指令運算後的 state root 要與計算後的結果一致。</li>
</ul>
<p><strong>Tally：<strong>用來證實</strong>計票者計票的正確性，避免計票者黑箱。</strong></p>
<hr/>
<h2 id="ecdh-shared-key--解釋"><a class="anchor" href="#ecdh-shared-key--解釋"><span class="icon icon-link"></span></a>ECDH shared key  解釋</h2>
<blockquote>
<p>在這邊我想簡單地解釋一下 ECDH 的概念，但是不會討論太深入的數學概念。</p>
</blockquote>
<p>在 ECDH 中的 DH 代表的是 Diffie-Hellman key exchange，兩位密碼學家創造了一個方法，可以在不安全通信通道中建立起一組「共享金鑰 (shared key )」，且這個金鑰只會由雙方計算得出來，並可以使雙方在此通道下以此金鑰進行加密 (encrypt )與解密 (decrypt )的方法；而 EC 則代表橢圓曲線加密。</p>
<p>下面來舉個例子，若有 Alice 與 Bob 想進行金鑰轉換，但是他們會通過一個公開的通道進行。</p>
<ol>
<li>若 Alice 與 Bob 說好使用特定的橢圓曲線，並使用他們知道的一基點 G 作為 generator。</li>
<li>Alice 選擇一個私鑰 a，計算其公鑰 A = a * G，並將 A 傳給 Bob。</li>
<li>Bob 也選擇一私鑰 b，計算其公鑰 B = b * G，也將 B 傳給 Alice。</li>
<li>這時，Alice 與 Bob 可以計算出一組只有他們知道的 shared key k = a _ b _ G (Alice ：得到 B = b * G，可以將其私鑰相乘即得到 k；反之亦然 )</li>
<li>此時在公開的訊息中只會觀察到 A 與 B 兩組公鑰，而在此通道中的其他人因為無法獲得 a、b，因而無法得到 k。</li>
<li>Alice 與 Bob 此時便可以使用 k 作為加密與解密的公鑰進行訊息交換。</li>
</ol>
<p>MACI 中就是利用這種交換金鑰的方式來加密，即使是在一個公開的通道上 (區塊鏈 )，也可以讓計票者可以透過共同金鑰計算投票者的訊息。</p>
<p>更詳盡的名詞解釋可見<a href="https://github.com/privacy-scaling-explorations/maci/blob/master/specs/01_introduction.md#glossary">此</a>。</p>
<p>更詳盡的系統設計圖可見圖 Z，並參見<a href="https://youtu.be/sKuNj_IQVYI">此影片</a>。</p>
<p><img src="https://i.imgur.com/a5Uajfz.png" alt=""/>
圖 Z、MACI 的系統圖</p>
<h2 id="結論"><a class="anchor" href="#結論"><span class="icon icon-link"></span></a>結論</h2>
<p>預防共謀在區塊鏈上是一件非常重要的事情，MACI 簡單的透過加密演算法的技術讓共謀這件事情變得困難，並且也利用 zkProof 來證實投票的正當性，在每個方面都思考的很縝密。但目前的架構中，仍有計票者與 😈  行賄者串通以得知 🤑  受賄者投的票 (因此只能假設計票者為完全公正 )，或是只使用單一的 server 進行運算等缺陷。目前 MACI 的開發也在進行中，預計是要將其運算的架構改成 <a href="https://en.wikipedia.org/wiki/Secure_multi-party_computation">MPC (Multiple-Party Computation )</a>。</p>
<p><strong>這邊放幾個我在讀 doc 與看範例時遇到的問題</strong></p>
<p>Q：投票者與 MACI 互動的時候，是透過自己的公私鑰還是 MACI 提供的公私鑰對與合約互動？</p>
<p>Ｑ：如果是 MACI 提供的公私鑰對，這樣則需要將一些 gas 傳進此公鑰產生的 address 嗎？還是會透過在 MACI 中的私鑰來與合約互動 ？</p>
<p>A：MACI 提供的公私鑰對是採用 EDDSA，而非 Ethereum 上使用的 ECDSA。因此是使用自己的錢包與合約互動，且不需擔心此錢包的隱私問題，我原本認為透過地址與合約互動則會洩露隱私，但是在此的隱私是指投票的結果被公開在鏈上被他人看見。</p>
<h2 id="references"><a class="anchor" href="#references"><span class="icon icon-link"></span></a>References</h2>
<p>Videos</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=zBUo7G95wYE">Privacy in Ethereum by Barry WhiteHat (Devcon5)</a></li>
<li><a href="https://youtu.be/sKuNj_IQVYI">Minimum Anti-Collusion Infrastructure (MACI)</a></li>
</ul>
<p>Articles</p>
<ul>
<li><a href="https://hackmd.io/@OFccBlU5TNCiRhpIyT1m7g/SkXv-gO5r#Introduction">MACI - Barry WhiteHat, Kendrick Tan, Kobi Gurkan, and Koh Wei Jie</a></li>
<li><a href="https://github.com/appliedzkp/maci/tree/master/specs">MACI spec</a>  (MACI 關於每個部分的說明 )</li>
<li><a href="https://medium.com/cryptocow/%E5%8B%95%E6%89%8B%E5%AF%A6%E5%81%9A%E9%9B%B6%E7%9F%A5%E8%AD%98-circom-d7ac1fa8bbd3">動手實作零知識 - circom</a></li>
<li><a href="https://medium.com/swf-lab/circom-snarkjs-728e4314e057">Circom &amp; Snarkjs</a></li>
</ul></div></article></div></main><footer class="py-8 flex justify-center items-center"><div class="max-w-5xl px-8 mx-auto"><i> <!-- -->Shout out to author of this template -<!-- --> <a class="text-gray-900 dark:text-white" href="https://twitter.com/hunterhchang">Hunter Chang</a></i></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h2: \"h2\",\n    a: \"a\",\n    span: \"span\",\n    p: \"p\",\n    ul: \"ul\",\n    li: \"li\",\n    em: \"em\",\n    blockquote: \"blockquote\",\n    strong: \"strong\",\n    pre: \"pre\",\n    code: \"code\",\n    hr: \"hr\",\n    h3: \"h3\",\n    ol: \"ol\",\n    img: \"img\",\n    br: \"br\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.h2, {\n      id: \"minimum-anti-collusion-infrastructure-maci\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#minimum-anti-collusion-infrastructure-maci\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Minimum Anti-Collusion Infrastructure (MACI)\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"author--acknowledgement\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#author--acknowledgement\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Author \u0026 acknowledgement\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Author: Fu-Chuan Chung @swfLAB\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Special thanks to @ for reviewing this article\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"建議具備知識\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#建議具備知識\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"建議具備知識\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"hash function\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"merkle tree\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"ECDSA、EDDSA\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"ethereum transaction\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"smart contract written by solidity\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"目錄\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#目錄\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"目錄\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"簡介\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"共謀\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"MACI higher-level  (基礎 )\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"MACI technical-level (深入 )\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"結論\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"簡介\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#簡介\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"簡介\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"MACI 的全名為 Minimum Anti-collusion Infrastructure，最初由 \", _jsx(_components.em, {\n        children: \"Vitalik\"\n      }), \" 在\", _jsx(_components.a, {\n        href: \"https://ethresear.ch/t/minimal-anti-collusion-infrastructure/5413\",\n        children: \"這篇貼文\"\n      }), \"提出，想法源自解決在區塊鏈上\", _jsx(_components.a, {\n        href: \"https://vitalik.ca/general/2019/04/03/collusion.html\",\n        children: \"共謀\"\n      }), \" (中文版詳見\", _jsx(_components.a, {\n        href: \"https://cla2srbchi.medium.com/%E7%BF%BB%E8%AD%AF-vitalik-on-collusion-%E8%AB%96%E5%85%B1%E8%AC%80-8ecd4e012266\",\n        children: \"此\"\n      }), \" )的問題，後續主要由 \", _jsx(_components.em, {\n        children: \"BarryWhiteHat\"\n      }), \" 與 \", _jsx(_components.em, {\n        children: \"Kendrick Tan, Kobi Gurkan\"\n      }), \" 和 \", _jsx(_components.em, {\n        children: \"Koh Wei Jie\"\n      }), \" 等人共同開發。\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"共謀\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#共謀\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"共謀\"]\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"為了避免產生語意上的差異，先說明關於一些名詞的解釋，我也會用圖案來呈現兩者差異\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"😈  行賄者 = 操縱者 = 意圖改變投票結果的人。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"🤑  受賄者 = 投票者 = 可以透過投票獲得來自行賄者利益的人。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"在深入介紹 MACI 之前，需要先理解何謂共謀 (collusion )？\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"「有些人會為了自己的利益串通他人，導致多數人的資源掌握在少數人手上」，這類的現象被稱為「共謀」。最常被舉到的例子就是「賄賂 (bribing )」，例如在投票時 😈 行賄者會為了投票結果而不擇手段地去收買、廣告、吸引票源。\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"觀察現實中的投票情景，政府會透過法律來限制賄賂的發生、投票的隱私、審/計票人員的公正等。但在區塊鏈中，由於任何資訊都是透明公開的，沒有任何有效的制度或法律可以限制共謀的行為。\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"甚至區塊鏈中的賄賂場景可能會以另一種較隱晦、難以看透的方式存在。例如某些 😈 行賄者會告訴投票者：「這並非賄賂，而是可分享利潤的質押」，使得在區塊鏈中賄賂變得明目張膽，也會因對於 😈 行賄者與 🤑 受賄者無法懲罰而難以遏止。\\n這邊舉一個在區塊鏈上投票的例子：\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-solidity\",\n      children: _jsxs(_components.code, {\n        className: \"language-solidity code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"// SPDX-License-Identifier: MIT\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"pragma\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"solidity\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"^\"\n          }), _jsx(_components.span, {\n            className: \"token version number\",\n            children: \"0.8.0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"contract\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token class-name\",\n            children: \"Voting\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"  \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"mapping\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"bytes32\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\u003e\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"uint256\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"public\"\n          }), \" votesReceived\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"// 用來記錄候選人獲得的票數\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"  \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"mapping\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"address\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\u003e\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"bool\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"public\"\n          }), \" voters\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"// 投票者名單\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"  \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"mapping\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"bytes32\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\u003e\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"bool\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"public\"\n          }), \" candidateList\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"  \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"/* constructor input example:\\n\"\n          })]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"    // John, Alice, Bob after keccak256\\n\"\n          })\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"    [\\n\"\n          })\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"\\t\\t\\t0x0bfa36c40b8771f59912a8b06e3ba9cd68504e69345a0ebcb952c3c6100ec88e,\\n\"\n          })\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"\\t\\t\\t0x6070f87e7650727769f301b1e264c58d77a49792dc17c13fe3cb44a9bb1f7b44,\\n\"\n          })\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"\\t\\t\\t0x780641b8ceca510c40f5f0178d126444811cc3e3edf7fa86f3656f77615dcc5c\\n\"\n          })\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"\\t\\t],\\n\"\n          })\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"    [\\n\"\n          })\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"\\t\\t\\t0xB5e30182B2EC04A58C8dFaB9f0E42Bbd5a551618,\\n\"\n          })\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"\\t\\t\\t0x5B38Da6a701c568545dCfcB03FcB875f56beddC4,\\n\"\n          })\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"\\t\\t\\t0xAb8483F64d9C6d1EcF9b849Ae677dD3315835cb2,\\n\"\n          })\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"\\t\\t\\t0x4B20993Bc481177ec7E8f571ceCaE8A9e22C02db\\n\"\n          })\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"\\t\\t]\\n\"\n          })\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"  */\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"  \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"constructor\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"bytes32\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"memory\"\n          }), \" _candidateNames\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"address\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"memory\"\n          }), \" _voters\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"uint8\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003c\"\n          }), \" _candidateNames\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"length\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \" i\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"++\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"// 候選人名單\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"      candidateList\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"_candidateNames\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"true\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"uint8\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003c\"\n          }), \" _voters\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"length\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \" i\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"++\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"// 投票的白名單\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"      voters\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"_voters\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"true\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"  \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"function\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"voteForCandidate\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"bytes32\"\n          }), \" candidate\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"public\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"// 投票\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"require\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"candidateList\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"candidate\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"input is not a candidate\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"require\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"voters\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"msg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"sender\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"invalid voter\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    votesReceived\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"candidate\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"這個合約利用 bytes32 來作為候選者的名稱，投票者可以透過 \", _jsx(_components.code, {\n        children: \"voteForCandidate()\"\n      }), \" ，直接輸入候選人的名稱進行投票。\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"任何人都可以從 etherscan 上直接看見我在鏈上投票的\", _jsx(_components.a, {\n        href: \"https://goerli.etherscan.io/tx/0xb6cd91327376b63b8a2b1227ccc8b6a6b3ccc4141e5c4f303b7b80618dd22b86\",\n        children: \"結果\"\n      }), \"，就是投給 \", _jsx(_components.em, {\n        children: \"John\"\n      }), \"。\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsxs(_components.code, {\n        className: \"code-highlight\",\n        children: [_jsx(_components.span, {\n          className: \"code-line\",\n          children: \"Function: voteForCandidate(bytes32 candidate) ***\\n\"\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"MethodID: 0xcc9ab267\\n\"\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"[0]:  0bfa36c40b8771f59912a8b06e3ba9cd68504e69345a0ebcb952c3c6100ec88e\\n\"\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"(byte32 of keccak256(\\\"John\\\"))\\n\"\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"😈  行賄者可以透過撰寫 script 抓取鏈上資料，或甚至可以直接透過智能合約來完成賄賂。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"🤑  受賄絡者可自行提供在鏈上投票的證明給 😈  行賄者。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"這樣子使得在區塊鏈上進行投票變得非常困難，\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"透過 MACI 建構的系統/ App \", _jsx(_components.strong, {\n        children: \"可以讓共謀者難以進行共謀\"\n      }), \"，且同時保留了審查的機制與在鏈上進行投票等特性。\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsxs(_components.h2, {\n      id: \"maci-流程：\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#maci-流程：\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"MACI 流程：\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"以下則會分成兩個流程講述：\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"第一個是在較高層次 (high-level )觀察投票流程，會利用一個例子來解釋 MACI 投票的流程，另一個流程則會解釋在投票時使用的技術 (technical-level )，本流程參考自此篇文章。\"\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"high-level\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#high-level\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"High Level\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"這邊會講述投票者如何與系統互動進行投票。\\n\", _jsx(_components.strong, {\n        children: \"前提\"\n      }), \"：\\n⭐️ 整個系統中會有兩個身份：\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"投票者 (Voter )：可以將一組公鑰送入 contract 中，使自己的身份變成投票者。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"計票者 (Coordinator )：系統中負責計票的角色，會進行計票的工作，其公鑰會公開讓所有人知道。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"⭐️ \", _jsx(_components.strong, {\n        children: \"基本流程\"\n      }), \"：\"]\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"註冊\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"投票 (簽章與加密 )\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"計票\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"投票流程 (實例 )\"\n      }), \"：\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"這個例子中有：\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"三個投票者：Alice、Bob、Charlie，其公私鑰分別為 keyPairA: (pubKeyA, privKeyA)、keyPairB、keyPairC。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"一個計票者：David，其公私鑰分別為 pubKeyD (公開的資訊 )、privKeyD (只有 David 知道 )。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"在建立合約後會有一個 sign-up 階段 (時間到了便無法再加入 )，投票者只有在這時候可以加入投票。此時 Alice、Bob、Charlie 則需要將他們的公鑰送到 MACI 的合約中以完成註冊。 (這邊的公私鑰並不是進行交易錢包中的那一對公私鑰，而是由鏈下 app 產生的公私鑰對 )\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"當 Alice 投票時，會將他的票 X (一段 message，像是上面例子中的 bytes32 )透過 privKeyA 簽章，得到 privA(X)\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"privA(X) 再經過 David 的 pubKeyD 加密，得到 encD(privA(X))，最後透過 MACI 的合約完成投票。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"透過 David 的公鑰加密後便只有 David 可以解開，因此只有 David 知道 Alice 到底投了什麼。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"此時若 😈 Bob 與 🤑 Alice 為行賄者與受賄者：Bob 便無法從鏈上直接得知 Alice 投給了誰；Alice 也無法透過鏈上的紀錄來向 Bob 證明他的投票結果。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"若 Alice 在投票時不幸被 Bob 逼迫，投給了 Alice 不想投的人。MACI 也提供了一個機制，可以讓 Alice 換一組公私鑰對 keyPairA': (privKeyA', pubKeyA')，再經由上述的 2、3 步驟進行投票。 (MACI 在最後計票時，會將原本的票數作廢，只計算其最新產生的票 )\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"最後，當投票時間結束時，計票人 David 會從合約將每張票 (簽章 \u0026 加密後的資訊 )抓下來，計算結果，並產生一段 zk proof 到合約上以更新票數。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.img, {\n        src: \"https://i.imgur.com/N5ZzWOd.png\",\n        alt: \"\"\n      }), \"\\n圖一、MACI 投票的簡化流程圖\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"透過 MACI，除了可以保護 Alice 的隱私 (只有計票者可以解密並紀錄 Alice 的投票結果 )，也可以提高賄賂的難度，使\", _jsx(_components.strong, {\n        children: \"共謀在 MACI 建立的投票系統下變的窒礙難行\"\n      }), \"。\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsxs(_components.h2, {\n      id: \"technical-level\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#technical-level\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Technical-Level\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"此段會是上段流程更深入的探討。\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"前提：\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"⭐️ 在 MACI 中投票或更換公鑰等未加密之動作稱為指令 (command )，而加密後的資訊稱為訊息 (message )。\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"⭐️ 加密流程：\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"將指令 (傳入內容 msg )雜湊後得到 h。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"利用系統給予的 EdDSA privKey ，將 h 進行簽章。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"利用一個隨機產生的 ephemeral key 與計票者的 pubKey' 產生出一組 ECDH shared key - Ekey。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"最後透過 Ekey 將簽章與指令中的 data 進行加密。 (計票者可以透過他的 privKey' 解開 )\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"投票流程\"\n      }), \"：\"]\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"首先，計票者會將投票的合約部署到鏈上，並開始 sign-up 階段，會將他的 pubKey’ 公開地儲存在合約中。\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [\"在 sign-up 階段，系統會隨機產生一組 EdDSA 計算出的公私鑰對給予投票者，投票者需要保存自己的私鑰 (privKey )，並將公鑰 (pubKey )傳到合約上進行註冊。\", _jsx(_components.strong, {\n            children: \"合約中會有一棵 Merkle Tree 紀錄整個投票者的註冊狀態、投票權重等 (詳細可見圖 X )\"\n          }), \"。\\n\", _jsx(_components.img, {\n            src: \"https://i.imgur.com/LanzW4W.png\",\n            alt: \"\"\n          }), _jsx(_components.br, {}), \"\\n\", \"圖 X、Sign-up 流程圖。\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"sign-up 階段結束，無法再加入其他的投票者，並進入投票階段。\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [\"投票時，投票者可以做兩種行為 (這些行為都可以透過 \", _jsx(_components.code, {\n            children: \"publishMessage()\"\n          }), \" 更新在合約中 )：\"]\n        }), \"\\n\", _jsxs(_components.ol, {\n          children: [\"\\n\", _jsxs(_components.li, {\n            children: [\"\\n\", _jsx(_components.p, {\n              children: \"投票：\\n投票者投的資訊會經由下面的處理上傳至合約中，並將訊息儲存在一棵 Message Tree 中：\"\n            }), \"\\n\", _jsxs(_components.ul, {\n              children: [\"\\n\", _jsx(_components.li, {\n                children: \"將指令 (投票內容 )雜湊後得到 hash。\"\n              }), \"\\n\", _jsx(_components.li, {\n                children: \"利用系統給予的 EdDSA privKey ，將 hash 進行簽章。\"\n              }), \"\\n\", _jsxs(_components.li, {\n                children: [\"利用一個隨機產生的 ephemeral key 與計票者的 pubKey’ 產生出一組 \", _jsx(_components.a, {\n                  href: \"https://zh.wikipedia.org/wiki/%E6%A9%A2%E5%9C%93%E6%9B%B2%E7%B7%9A%E8%BF%AA%E8%8F%B2-%E8%B5%AB%E7%88%BE%E6%9B%BC%E9%87%91%E9%91%B0%E4%BA%A4%E6%8F%9B\",\n                  children: \"ECDH\"\n                }), \" shared key Ekey。 (計票者可以透過他的 )\"]\n              }), \"\\n\", _jsxs(_components.li, {\n                children: [\"最後透過 Ekey 將\", _jsx(_components.strong, {\n                  children: \"簽章與指令中的 data 進行加密。\"\n                })]\n              }), \"\\n\"]\n            }), \"\\n\"]\n          }), \"\\n\", _jsxs(_components.li, {\n            children: [\"\\n\", _jsx(_components.p, {\n              children: \"更改公鑰：\"\n            }), \"\\n\", _jsx(_components.p, {\n              children: \"若某人被 😈  行賄者逼迫投出非意願的票時，可以透過 publisgMessage 更改其公鑰，而更改的動作其實與投票類似，只是在一開始簽章時將傳入的投票訊息改成新的公鑰 (newPubKey )，更改後便可以用新的公鑰再進行投票了。\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\", _jsx(_components.p, {\n          children: \"關於 message 的敘述可見圖 Y。\"\n        }), \"\\n\", _jsxs(_components.p, {\n          children: [_jsx(_components.img, {\n            src: \"https://i.imgur.com/129kbaI.png\",\n            alt: \"\"\n          }), \"\\n圖 Y、來自 Vitalik 在 \", _jsx(_components.a, {\n            href: \"https://ethresear.ch/t/minimal-anti-collusion-infrastructure/5413\",\n            children: \"ethresear 中提案\"\n          }), \"的內容。\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [\"投票階段結束，計票者需要\", _jsx(_components.strong, {\n            children: \"解密與紀錄\"\n          }), \"所有人的票以統計結果。\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsxs(_components.p, {\n          children: [\"避免計票者黑箱，在計票時會\", _jsx(_components.strong, {\n            children: \"使用 zk-snark 的 proof\"\n          }), \" 讓系統可以不透過公布投票者投出的票卷內容，但可以證實所有計票的公正性 (類似實體投票時的唱票，在旁有投票者監督 )。\"]\n        }), \"\\n\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"在 MACI 中有兩個 zk-SNARK circuit，也代表計票者需要執行的兩個動作 (process \u0026 tally )：\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Process\"\n      }), \"：是用來證實在\", _jsx(_components.strong, {\n        children: \"鏈上 state tree transition 的正確性 (確認所有票都是 valid )\"\n      }), \"，其中會檢查三件事：\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"使用正確的 key 進行加密。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"解密出來的 message 有儲存在 message tree 中。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"指令運算後的 state root 要與計算後的結果一致。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsxs(_components.strong, {\n        children: [\"Tally：\", _jsx(_components.strong, {\n          children: \"用來證實\"\n        }), \"計票者計票的正確性，避免計票者黑箱。\"]\n      })\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsxs(_components.h2, {\n      id: \"ecdh-shared-key--解釋\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#ecdh-shared-key--解釋\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"ECDH shared key  解釋\"]\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"在這邊我想簡單地解釋一下 ECDH 的概念，但是不會討論太深入的數學概念。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"在 ECDH 中的 DH 代表的是 Diffie-Hellman key exchange，兩位密碼學家創造了一個方法，可以在不安全通信通道中建立起一組「共享金鑰 (shared key )」，且這個金鑰只會由雙方計算得出來，並可以使雙方在此通道下以此金鑰進行加密 (encrypt )與解密 (decrypt )的方法；而 EC 則代表橢圓曲線加密。\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"下面來舉個例子，若有 Alice 與 Bob 想進行金鑰轉換，但是他們會通過一個公開的通道進行。\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"若 Alice 與 Bob 說好使用特定的橢圓曲線，並使用他們知道的一基點 G 作為 generator。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Alice 選擇一個私鑰 a，計算其公鑰 A = a * G，並將 A 傳給 Bob。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Bob 也選擇一私鑰 b，計算其公鑰 B = b * G，也將 B 傳給 Alice。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"這時，Alice 與 Bob 可以計算出一組只有他們知道的 shared key k = a _ b _ G (Alice ：得到 B = b * G，可以將其私鑰相乘即得到 k；反之亦然 )\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"此時在公開的訊息中只會觀察到 A 與 B 兩組公鑰，而在此通道中的其他人因為無法獲得 a、b，因而無法得到 k。\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Alice 與 Bob 此時便可以使用 k 作為加密與解密的公鑰進行訊息交換。\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"MACI 中就是利用這種交換金鑰的方式來加密，即使是在一個公開的通道上 (區塊鏈 )，也可以讓計票者可以透過共同金鑰計算投票者的訊息。\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"更詳盡的名詞解釋可見\", _jsx(_components.a, {\n        href: \"https://github.com/privacy-scaling-explorations/maci/blob/master/specs/01_introduction.md#glossary\",\n        children: \"此\"\n      }), \"。\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"更詳盡的系統設計圖可見圖 Z，並參見\", _jsx(_components.a, {\n        href: \"https://youtu.be/sKuNj_IQVYI\",\n        children: \"此影片\"\n      }), \"。\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.img, {\n        src: \"https://i.imgur.com/a5Uajfz.png\",\n        alt: \"\"\n      }), \"\\n圖 Z、MACI 的系統圖\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"結論\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#結論\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"結論\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"預防共謀在區塊鏈上是一件非常重要的事情，MACI 簡單的透過加密演算法的技術讓共謀這件事情變得困難，並且也利用 zkProof 來證實投票的正當性，在每個方面都思考的很縝密。但目前的架構中，仍有計票者與 😈  行賄者串通以得知 🤑  受賄者投的票 (因此只能假設計票者為完全公正 )，或是只使用單一的 server 進行運算等缺陷。目前 MACI 的開發也在進行中，預計是要將其運算的架構改成 \", _jsx(_components.a, {\n        href: \"https://en.wikipedia.org/wiki/Secure_multi-party_computation\",\n        children: \"MPC (Multiple-Party Computation )\"\n      }), \"。\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"這邊放幾個我在讀 doc 與看範例時遇到的問題\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Q：投票者與 MACI 互動的時候，是透過自己的公私鑰還是 MACI 提供的公私鑰對與合約互動？\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Ｑ：如果是 MACI 提供的公私鑰對，這樣則需要將一些 gas 傳進此公鑰產生的 address 嗎？還是會透過在 MACI 中的私鑰來與合約互動 ？\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"A：MACI 提供的公私鑰對是採用 EDDSA，而非 Ethereum 上使用的 ECDSA。因此是使用自己的錢包與合約互動，且不需擔心此錢包的隱私問題，我原本認為透過地址與合約互動則會洩露隱私，但是在此的隱私是指投票的結果被公開在鏈上被他人看見。\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"references\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#references\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"References\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Videos\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://www.youtube.com/watch?v=zBUo7G95wYE\",\n          children: \"Privacy in Ethereum by Barry WhiteHat (Devcon5)\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://youtu.be/sKuNj_IQVYI\",\n          children: \"Minimum Anti-Collusion Infrastructure (MACI)\"\n        })\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Articles\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://hackmd.io/@OFccBlU5TNCiRhpIyT1m7g/SkXv-gO5r#Introduction\",\n          children: \"MACI - Barry WhiteHat, Kendrick Tan, Kobi Gurkan, and Koh Wei Jie\"\n        })\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.a, {\n          href: \"https://github.com/appliedzkp/maci/tree/master/specs\",\n          children: \"MACI spec\"\n        }), \"  (MACI 關於每個部分的說明 )\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://medium.com/cryptocow/%E5%8B%95%E6%89%8B%E5%AF%A6%E5%81%9A%E9%9B%B6%E7%9F%A5%E8%AD%98-circom-d7ac1fa8bbd3\",\n          children: \"動手實作零知識 - circom\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://medium.com/swf-lab/circom-snarkjs-728e4314e057\",\n          children: \"Circom \u0026 Snarkjs\"\n        })\n      }), \"\\n\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{"title":"Introduction of MACI","description":"在區塊鏈投票時，常會發生「共謀」的現象 (最常見的就是賄賂 )，而為了遏止此現象的發生，Barry White Hat 與 Ethereum 中其他成員建構了 MACI 這個 protocol...","date":"2023-02-04"}},"frontMatter":{"title":"Introduction of MACI","description":"在區塊鏈投票時，常會發生「共謀」的現象 (最常見的就是賄賂 )，而為了遏止此現象的發生，Barry White Hat 與 Ethereum 中其他成員建構了 MACI 這個 protocol...","date":"2023-02-04"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"MACI"},"buildId":"Gy7Rb-D_XwjaylTu5JJGQ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>